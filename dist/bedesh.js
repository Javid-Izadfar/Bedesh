(function(l){"object"===typeof exports&&"undefined"!==typeof module?module.exports=l():"function"===typeof define&&define.amd?define([],l):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Bedesh=l()})(function(){return function d(g,f,e){function c(b,k){if(!f[b]){if(!g[b]){var h="function"==typeof require&&require;if(!k&&h)return h(b,!0);if(a)return a(b,!0);h=Error("Cannot find module '"+b+"'");throw h.code="MODULE_NOT_FOUND",h;}h=f[b]={exports:{}};
g[b][0].call(h.exports,function(a){var e=g[b][1][a];return c(e?e:a)},h,h.exports,d,g,f,e)}return f[b].exports}for(var a="function"==typeof require&&require,b=0;b<e.length;b++)c(e[b]);return c}({1:[function(d,g,f){function e(c,a){return a.querySelector(c)}f=g.exports=function(c,a){a=a||document;return e(c,a)};f.all=function(c,a){a=a||document;return a.querySelectorAll(c)};f.engine=function(c){if(!c.one)throw Error(".one callback required");if(!c.all)throw Error(".all callback required");e=c.one;f.all=
c.all;return f}},{}],2:[function(d,g,f){f=g.exports=function(e){e||(e={});"string"===typeof e&&(e={cookie:e});void 0===e.cookie&&(e.cookie="");return{get:function(c){for(var a=e.cookie.split(/;\s*/),b=0;b<a.length;b++){var d=a[b].split("=");if(unescape(d[0])===c)return unescape(d[1])}},set:function(c,a,b){b||(b={});c=escape(c)+"="+escape(a);b.expires&&(c+="; expires="+b.expires);b.path&&(c+="; path="+escape(b.path));return e.cookie=c}}};"undefined"!==typeof document&&(d=f(document),f.get=d.get,f.set=
d.set)},{}],3:[function(d,g,f){var e={},c=/^[-!#$%&'*+\/0-9=?A-Z^_a-z{|}~](\.?[-!#$%&'*+\/0-9=?A-Z^_a-z`{|}~])*@[a-zA-Z0-9](-?\.?[a-zA-Z0-9])*\.[a-zA-Z](-?[a-zA-Z0-9])+$/;e.validate=function(a){if(!a||254<a.length||!c.test(a))return!1;a=a.split("@");return 64<a[0].length||a[1].split(".").some(function(a){return 63<a.length})?!1:!0};e.validate_async=function(a,b){var c=!1;try{c=e.validate(a),b(null,c)}catch(k){b(k,c)}};g.exports=e},{}],4:[function(d,g,f){d=d("has-dom");g.exports=d()?document:null},
{"has-dom":5}],5:[function(d,g,f){g.exports=function(){return"undefined"!==typeof window&&"undefined"!==typeof document&&"function"===typeof document.createElement}},{}],6:[function(d,g,f){g.exports=function(c){for(var a=1;a<arguments.length;a++){var b=arguments[a],d;for(d in b)e.call(b,d)&&(c[d]=b[d])}return c};var e=Object.prototype.hasOwnProperty},{}],7:[function(d,g,f){var e=d("xtend/mutable"),c=d("component-query"),a=d("get-doc"),b=d("cookie-cutter"),h=d("email-validator"),k=Number(new Date),
m=a&&a.documentElement;d=function(a){this.options=e({},{daysHidden:15,daysReminder:90,headerContent:"",bodyContent:"",formAction:"",force:!1,onSubmit:function(){},onClose:function(){}},a||a||{});a=b.get("Bedesh-closed");var c=b.get("Bedesh-submited");if(this.options.force||!a&&!c)this.create(),this.show()};d.prototype={constructor:d,create:function(){var b=a.createElement("div");b.className="bedesh";b.innerHTML='<div class="bedesh-overlay bedesh-close"></div><div class="bedesh-container"><div class="bedesh-header">'+
this.options.headerContent+'</div><div class="bedesh-body"><form action="'+this.options.formAction+'" novalidate>'+this.options.bodyContent+'<input type="email" placeholder="\u0627\u06cc\u0645\u06cc\u0644 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f"><input type="submit" value="\u062b\u0628\u062a \u0627\u06cc\u0645\u06cc\u0644"></form></div></div>';a.body?a.body.appendChild(b):a&&a.addEventListener("DOMContentLoaded",function(){a.body.appendChild(b)});c("form",
b).addEventListener("submit",this.submit.bind(this),!1);c(".bedesh-close",b).addEventListener("click",this.close.bind(this),!1)},hide:function(){m.classList.remove("bedesh-show")},show:function(){m.classList.add("bedesh-show")},close:function(){this.options.onClose.call();this.hide();b.set("Bedesh-closed","true",{path:"/",expires:this.getExpirationDate(this.options.daysHidden)})},submit:function(){event.preventDefault();var a=c('input[type="email"]',modal).value;h.validate(a)?(this.options.formAction||
this.options.onSubmit.call(),this.hide(),b.set("Bedesh-submited","true",{path:"/",expires:this.getExpirationDate(this.options.daysReminder)})):this.showError("\u0627\u06cc\u0645\u06cc\u0644 \u0645\u0639\u062a\u0628\u0631 \u0646\u0645\u06cc\u200c\u0628\u0627\u0634\u062f.")},showError:function(b){if(c(".bedesh-error",modal))c(".bedesh-error",modal).innerText=b;else{var d=a.createElement("span");d.className="bedesh-error";d.innerText=b;c(".bedesh-body",modal).appendChild(d)}setTimeout(function(){c(".bedesh-error",
modal).outerHTML=""},5E3)},getExpirationDate:function(a){return new Date(k+864E5*a)}};g.exports=d},{"component-query":1,"cookie-cutter":2,"email-validator":3,"get-doc":4,"xtend/mutable":6}]},{},[7])(7)});
